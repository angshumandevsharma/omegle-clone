{"ast":null,"code":"var _jsxFileName = \"/Users/as/omegle-clone/client/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io('http://localhost:5000'); // Make sure this is correct\n\nconst App = () => {\n  _s();\n  const [partnerId, setPartnerId] = useState(null);\n  const localVideoRef = useRef();\n  const remoteVideoRef = useRef();\n  const peerConnection = useRef(null);\n  useEffect(() => {\n    console.log('üöÄ Connecting to backend...');\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      localVideoRef.current.srcObject = stream;\n      peerConnection.current = new RTCPeerConnection();\n      stream.getTracks().forEach(track => {\n        peerConnection.current.addTrack(track, stream);\n      });\n      peerConnection.current.ontrack = event => {\n        console.log('üì∫ Got remote track');\n        remoteVideoRef.current.srcObject = event.streams[0];\n      };\n      peerConnection.current.onicecandidate = event => {\n        if (event.candidate && partnerId) {\n          socket.emit('signal', {\n            to: partnerId,\n            data: {\n              candidate: event.candidate\n            }\n          });\n        }\n      };\n      socket.on('partner-found', async ({\n        partnerId\n      }) => {\n        console.log('ü§ù Partner found:', partnerId);\n        setPartnerId(partnerId);\n\n        // Create offer if initiating\n        const offer = await peerConnection.current.createOffer();\n        await peerConnection.current.setLocalDescription(offer);\n        socket.emit('signal', {\n          to: partnerId,\n          data: {\n            sdp: offer\n          }\n        });\n      });\n      socket.on('signal', async ({\n        from,\n        data\n      }) => {\n        if (data.sdp) {\n          await peerConnection.current.setRemoteDescription(new RTCSessionDescription(data.sdp));\n          if (data.sdp.type === 'offer') {\n            const answer = await peerConnection.current.createAnswer();\n            await peerConnection.current.setLocalDescription(answer);\n            socket.emit('signal', {\n              to: from,\n              data: {\n                sdp: answer\n              }\n            });\n          }\n        } else if (data.candidate) {\n          await peerConnection.current.addIceCandidate(new RTCIceCandidate(data.candidate));\n        }\n      });\n      socket.on('partner-disconnected', () => {\n        console.log('üíî Partner disconnected');\n        remoteVideoRef.current.srcObject = null;\n      });\n    }).catch(err => console.error('‚ùå Media error:', err));\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-around',\n      marginTop: '50px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"You\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: localVideoRef,\n        autoPlay: true,\n        playsInline: true,\n        muted: true,\n        width: \"400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Stranger\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: remoteVideoRef,\n        autoPlay: true,\n        playsInline: true,\n        width: \"400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"A3T0DVszFqu2oRXXur3XMtk4k6k=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useRef","useState","io","jsxDEV","_jsxDEV","socket","App","_s","partnerId","setPartnerId","localVideoRef","remoteVideoRef","peerConnection","console","log","navigator","mediaDevices","getUserMedia","video","audio","then","stream","current","srcObject","RTCPeerConnection","getTracks","forEach","track","addTrack","ontrack","event","streams","onicecandidate","candidate","emit","to","data","on","offer","createOffer","setLocalDescription","sdp","from","setRemoteDescription","RTCSessionDescription","type","answer","createAnswer","addIceCandidate","RTCIceCandidate","catch","err","error","style","display","justifyContent","marginTop","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","playsInline","muted","width","_c","$RefreshReg$"],"sources":["/Users/as/omegle-clone/client/src/App.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport io from 'socket.io-client';\n\nconst socket = io('http://localhost:5000'); // Make sure this is correct\n\nconst App = () => {\n  const [partnerId, setPartnerId] = useState(null);\n  const localVideoRef = useRef();\n  const remoteVideoRef = useRef();\n  const peerConnection = useRef(null);\n\n  useEffect(() => {\n    console.log('üöÄ Connecting to backend...');\n\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n      .then((stream) => {\n        localVideoRef.current.srcObject = stream;\n\n        peerConnection.current = new RTCPeerConnection();\n\n        stream.getTracks().forEach((track) => {\n          peerConnection.current.addTrack(track, stream);\n        });\n\n        peerConnection.current.ontrack = (event) => {\n          console.log('üì∫ Got remote track');\n          remoteVideoRef.current.srcObject = event.streams[0];\n        };\n\n        peerConnection.current.onicecandidate = (event) => {\n          if (event.candidate && partnerId) {\n            socket.emit('signal', {\n              to: partnerId,\n              data: { candidate: event.candidate }\n            });\n          }\n        };\n\n        socket.on('partner-found', async ({ partnerId }) => {\n          console.log('ü§ù Partner found:', partnerId);\n          setPartnerId(partnerId);\n\n          // Create offer if initiating\n          const offer = await peerConnection.current.createOffer();\n          await peerConnection.current.setLocalDescription(offer);\n\n          socket.emit('signal', {\n            to: partnerId,\n            data: { sdp: offer }\n          });\n        });\n\n        socket.on('signal', async ({ from, data }) => {\n          if (data.sdp) {\n            await peerConnection.current.setRemoteDescription(new RTCSessionDescription(data.sdp));\n\n            if (data.sdp.type === 'offer') {\n              const answer = await peerConnection.current.createAnswer();\n              await peerConnection.current.setLocalDescription(answer);\n\n              socket.emit('signal', {\n                to: from,\n                data: { sdp: answer }\n              });\n            }\n          } else if (data.candidate) {\n            await peerConnection.current.addIceCandidate(new RTCIceCandidate(data.candidate));\n          }\n        });\n\n        socket.on('partner-disconnected', () => {\n          console.log('üíî Partner disconnected');\n          remoteVideoRef.current.srcObject = null;\n        });\n      })\n      .catch((err) => console.error('‚ùå Media error:', err));\n  }, []);\n\n  return (\n    <div style={{ display: 'flex', justifyContent: 'space-around', marginTop: '50px' }}>\n      <div>\n        <h2>You</h2>\n        <video ref={localVideoRef} autoPlay playsInline muted width=\"400\" />\n      </div>\n      <div>\n        <h2>Stranger</h2>\n        <video ref={remoteVideoRef} autoPlay playsInline width=\"400\" />\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}